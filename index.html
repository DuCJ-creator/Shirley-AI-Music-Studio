<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Shirley's AI Music Studio | Moonlight Premium</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Cormorant+Garamond:wght@500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-0: #05040a; --accent: #9fffe6; --ink: #e7f7f7;
      --clock-size: min(72vw, 420px);
      --record-size: 100px;
    }

    body {
      margin: 0; background: var(--bg-0); color: var(--ink);
      font-family: "Orbitron", sans-serif; overflow: hidden;
      height: 100vh; display: flex; align-items: center; justify-content: center;
    }

    #particle-bg { position: fixed; inset: 0; z-index: 0; }

    /* æ¨™é¡Œå¾©åˆ» */
    #header {
      position: absolute; top: 10%; left: 8%; z-index: 10;
      text-align: left; pointer-events: none;
    }
    #main-title {
      font-size: 2.2rem; letter-spacing: 0.35em; margin: 0; font-weight: 700;
      text-shadow: 0 0 15px rgba(159,255,230,0.5);
    }
    #sub-title {
      font-family: "Cormorant Garamond", serif; font-size: 1.3rem;
      letter-spacing: 0.6em; margin-top: 8px; opacity: 0.8;
    }

    /* è¡¨ç›¤ç³»çµ± */
    #clock-container {
      position: relative; right: 5%;
      width: var(--clock-size); height: var(--clock-size);
      z-index: 5;
    }
    .clock-outer {
      position: absolute; inset: 0; border-radius: 50%;
      border: 1px solid rgba(159, 255, 230, 0.2);
      background: radial-gradient(circle, rgba(20,20,30,0.6) 0%, #050509 100%);
    }

    /* é‘½çŸ³ğŸ’æ™‚æ¨™ - éœæ…‹ç™¼å…‰ï¼Œå›ºå®šåœ¨æ•´é»ä½ç½® */
    .hour-marker {
      position: absolute; 
      width: 16px; height: 16px;
      background: 
        radial-gradient(circle at 30% 30%, 
          rgba(255, 255, 255, 1) 0%, 
          var(--accent) 40%, 
          rgba(159, 255, 230, 0.3) 70%,
          transparent 90%
        );
      clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);
      filter: drop-shadow(0 0 6px var(--accent));
      z-index: 6;
      opacity: 0.85;
      transform: rotate(var(--diamond-rotation, 0deg)) translate(-50%, -50%);
      transition: all 0.3s ease;
      pointer-events: auto; /* ç¢ºä¿å¯ä»¥é»æ“Š */
    }

    /* ç§»é™¤è·³å‹•å‹•ç•«ï¼Œæ”¹ç‚ºé¼ æ¨™æ‡¸åœæ•ˆæœ */
    .hour-marker:hover {
      filter: drop-shadow(0 0 12px var(--accent)) 
              drop-shadow(0 0 6px rgba(255, 255, 255, 0.8));
      opacity: 1;
      transform: rotate(var(--diamond-rotation, 0deg)) translate(-50%, -50%) scale(1.3);
    }

    /* ç‰¹åˆ¥å¼·èª¿12é»ã€3é»ã€6é»ã€9é»çš„é‘½çŸ³ */
    .hour-marker.hour-12,
    .hour-marker.hour-3,
    .hour-marker.hour-6,
    .hour-marker.hour-9 {
      width: 18px;
      height: 18px;
      filter: drop-shadow(0 0 8px var(--accent));
    }

    #record {
      position: absolute; top: 50%; left: 50%;
      width: var(--record-size); height: var(--record-size);
      transform: translate(-50%, -50%); border-radius: 50%;
      border: 2px solid var(--accent); overflow: hidden;
      cursor: pointer; z-index: 20; box-shadow: 0 0 20px var(--accent);
    }
    video { width: 100%; height: 100%; object-fit: cover; }

    #hand {
      position: absolute; width: 3px; height: 44%;
      background: linear-gradient(to top, var(--accent), transparent);
      bottom: 50%; left: calc(50% - 1.5px); transform-origin: bottom center;
      transition: transform 0.8s cubic-bezier(0.19, 1, 0.22, 1);
      z-index: 10;
    }

    /* å°èˆª */
    .nav-node {
      position: absolute; text-decoration: none; color: var(--ink);
      z-index: 25; font-size: 0.85rem; font-weight: bold;
      padding: 10px 20px; border-radius: 30px;
      background: rgba(10,12,18,0.85); border: 1px solid rgba(159,255,230,0.2);
      transition: 0.3s; white-space: nowrap;
    }
    .nav-node:hover { border-color: var(--accent); box-shadow: 0 0 15px var(--accent); transform: translateY(-50%) scale(1.1); }
    #node-emo { left: -50px; top: 50%; transform: translateY(-50%); }
    #node-study { right: -50px; top: 50%; transform: translateY(-50%); }

    /* æ­Œè©è»Œé“ - æ”¹é€²æ¼‚æµ®é‚è¼¯ */
    #lyric-orbit-container { position: absolute; inset: 0; pointer-events: none; }
    .lyric-card {
      position: absolute; width: 220px; pointer-events: auto;
      background: rgba(15, 20, 35, 0.8); border: 1px solid rgba(159, 255, 230, 0.2);
      border-radius: 10px; transition: width 0.4s, background 0.4s, transform 0.1s linear;
      padding: 12px; overflow: hidden;
    }
    .lyric-card.expanded {
      width: 280px; background: rgba(20, 30, 50, 0.98);
      border-color: var(--accent); z-index: 1000 !important;
    }
    .lyric-title { 
      font-size: 0.75rem; color: var(--accent); font-weight: bold; 
      letter-spacing: 1px; cursor: pointer; display: flex; justify-content: space-between;
    }
    .lyric-content {
      max-height: 0; opacity: 0; margin-top: 0;
      font-family: "Cormorant Garamond", serif; font-size: 0.9rem;
      line-height: 1.4; color: #fff; transition: all 0.4s ease;
      white-space: pre-line;
    }
    .expanded .lyric-content { max-height: 250px; opacity: 1; margin-top: 10px; }
  </style>
</head>
<body>

  <div id="particle-bg"></div>

  <div id="header">
    <h1 id="main-title">SHIRLEY'S AI MUSIC STUDIO</h1>
    <div id="sub-title">æœˆå…‰å¥é³´æ›²</div>
  </div>

  <div id="clock-container">
    <div class="clock-outer"></div>
    <div id="hand"></div>
    
    <!-- é‘½çŸ³ğŸ’æ™‚æ¨™æœƒåœ¨ JavaScript ä¸­å‹•æ…‹ç”Ÿæˆ -->
    
    <a href="#" class="nav-node" id="node-emo" onmouseenter="setHand(-90)">EMO æ“ºçˆ›ä¸­</a>
    <div id="record" onclick="togglePlay()">
      <video id="v" loop playsinline><source src="https://ducj-creator.github.io/Shirley-AI-Music-Studio/assets/moonlight%20sonata.mp4" type="video/mp4"></video>
    </div>
    <a href="https://ducj-creator.github.io/Shirley-AI-Music-Studio/learning/index.html" class="nav-node" id="node-study" onmouseenter="setHand(90)">å……é›»å­¸ç¿’ä¸­</a>
  </div>

  <div id="lyric-orbit-container"></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script>
    // 1. æ·±åº¦æ˜Ÿè¾°èƒŒæ™¯ (å„ªåŒ–ï¼šæ›´ç´°ã€æ›´å¤šã€ä¸ç™¼ç†±)
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 1, 1000);
    camera.position.z = 500;
    const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: false });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
    document.getElementById('particle-bg').appendChild(renderer.domElement);

    const geo = new THREE.BufferGeometry();
    const pCount = 6000; // å¢åŠ æ•¸é‡
    const pArr = new Float32Array(pCount * 3);
    for(let i=0; i<pCount*3; i++) pArr[i] = (Math.random()-0.5) * 1200;
    geo.setAttribute('position', new THREE.BufferAttribute(pArr, 3));
    
    // ç¸®å° size åˆ° 0.8 - 1.2 ç‡Ÿé€ æ˜Ÿå¡µæ„Ÿ
    const mat = new THREE.PointsMaterial({ color: 0x9fffe6, size: 0.8, transparent: true, opacity: 0.5, sizeAttenuation: true });
    const particles = new THREE.Points(geo, mat);
    scene.add(particles);

    function animate() {
      requestAnimationFrame(animate);
      particles.rotation.y += 0.0004;
      particles.rotation.z += 0.0002;
      renderer.render(scene, camera);
    }
    animate();

    // 2. å‰µå»ºé‘½çŸ³ğŸ’æ™‚æ¨™ - å›ºå®šåœ¨12å€‹æ•´é»ä½ç½®
    function createDiamondMarkers() {
      const clockContainer = document.getElementById('clock-container');
      const clockSize = parseInt(getComputedStyle(clockContainer).width);
      const center = clockSize / 2;
      const radius = center - 25; // é‘½çŸ³è·é›¢ä¸­å¿ƒçš„è·é›¢ï¼ˆæ¯”ä¹‹å‰æ›´é è¿‘é‚Šç·£ä¸€äº›ï¼‰
      
      // 12å€‹æ•´é»ä½ç½®ï¼š12é»ã€1é»ã€2é»...11é»
      const hourPositions = [
        { hour: 12, angle: 0 },    // 12é» - é ‚éƒ¨
        { hour: 1, angle: 30 },    // 1é»
        { hour: 2, angle: 60 },    // 2é»
        { hour: 3, angle: 90 },    // 3é» - å³å´
        { hour: 4, angle: 120 },   // 4é»
        { hour: 5, angle: 150 },   // 5é»
        { hour: 6, angle: 180 },   // 6é» - åº•éƒ¨
        { hour: 7, angle: 210 },   // 7é»
        { hour: 8, angle: 240 },   // 8é»
        { hour: 9, angle: 270 },   // 9é» - å·¦å´
        { hour: 10, angle: 300 },  // 10é»
        { hour: 11, angle: 330 }   // 11é»
      ];
      
      hourPositions.forEach(pos => {
        const angleRad = (pos.angle - 90) * Math.PI / 180; // å¾12é»é–‹å§‹ï¼Œé †æ™‚é‡è¨ˆç®—
        
        // è¨ˆç®—é‘½çŸ³ä½ç½®
        const x = center + Math.cos(angleRad) * radius;
        const y = center + Math.sin(angleRad) * radius;
        
        const marker = document.createElement('div');
        marker.className = 'hour-marker';
        marker.classList.add(`hour-${pos.hour}`);
        
        // è¨­ç½®ä½ç½®ï¼ˆä½¿ç”¨ç™¾åˆ†æ¯”å®šä½ï¼Œé€™æ¨£å¯ä»¥é©æ‡‰ä¸åŒå¤§å°çš„è¡¨ç›¤ï¼‰
        marker.style.left = `${x}px`;
        marker.style.top = `${y}px`;
        
        // ç‚ºæ¯å€‹é‘½çŸ³æ·»åŠ æ—‹è½‰è§’åº¦ï¼Œè®“å°–è§’æŒ‡å‘ä¸­å¿ƒ
        const rotation = pos.angle; // é‘½çŸ³æŒ‡å‘ä¸­å¿ƒ
        marker.style.setProperty('--diamond-rotation', `${rotation}deg`);
        
        // è¨­ç½®é€æ˜åº¦ - ä¸»è¦å››é»æ›´äº®
        if (pos.hour === 12 || pos.hour === 3 || pos.hour === 6 || pos.hour === 9) {
          marker.style.opacity = '0.95';
        } else {
          marker.style.opacity = '0.8';
        }
        
        // æ·»åŠ å°æ™‚æ•¸å­—æç¤ºï¼ˆå¯é¸ï¼Œç”¨æ–¼èª¿è©¦ï¼‰
        marker.title = `${pos.hour}é»é˜ä½ç½®`;
        
        clockContainer.appendChild(marker);
      });
    }

    // 3. æ­Œè©æ•¸æ“š
    const lyricsData = [
      { t: "Verse 1", c: "Close your eyes, let the tide of night pull you deep\nWhere silver whispers through the willow weep\nEvery worry, every weight you carry, set it free\nOn this silent sea, just breathe" },
      { t: "Pre-Chorus", c: "Feel the shadows soften, turning into silk\nAs the constellations witness, spilling their light like milk" },
      { t: "Chorus", c: "Luna, Luna, keeper of the quiet glow\nWashing over every secret that we know\nLuna, Luna, in your phosphorescent tide\nAll our fractured pieces learn to rest inside" },
      { t: "Verse 2", c: "See the dust of stars on your windowpane\nA reminder that even darkness is not in vain\nIt's a blanket, a cradle, a celestial embrace" },
      { t: "Bridge", c: "Hush now\nThe moon is listening\nAll is understood\nIn this velvet nothingness" },
      { t: "Outro", c: "Luna, Luna, keeper of the quiet glow\nWashing over everything we know\nLuna, Luna, in your tender tide\nWe are perfectly alight, inside" }
    ];

    const container = document.getElementById('lyric-orbit-container');
    
    // åˆå§‹åŒ–ä½ç½®åç§»é‡ï¼Œè®“å¡ç‰‡ä¸€é–‹å§‹å°±å‡å‹»åˆ†å¸ƒ
    const cards = lyricsData.map((data, i) => {
      const card = document.createElement('div');
      card.className = 'lyric-card';
      card.innerHTML = `<div class="lyric-title"><span>${data.t}</span><span>ï¼‹</span></div><div class="lyric-content">${data.c}</div>`;
      
      // çµ¦äºˆæ¯å€‹å¡ç‰‡ä¸€å€‹éš¨æ©Ÿçš„åˆå§‹æ™‚é–“åç§»
      card.dataset.offset = Math.random() * 10000; 
      
      card.onclick = (e) => {
        const isExp = card.classList.contains('expanded');
        document.querySelectorAll('.lyric-card').forEach(c => c.classList.remove('expanded'));
        if(!isExp) card.classList.add('expanded');
        e.stopPropagation();
      };
      container.appendChild(card);
      return card;
    });

    function updateOrbit() {
      const now = Date.now();
      const centerX = window.innerWidth * 0.75;
      const centerY = window.innerHeight * 0.5;

      cards.forEach((card, i) => {
        if(card.classList.contains('expanded')) return;

        // ä½¿ç”¨åˆå§‹åç§»é‡ï¼Œç¢ºä¿ä¸€é€²ç¶²é æ™‚å¡ç‰‡å°±åœ¨ä¸åŒä½ç½®
        const offset = parseFloat(card.dataset.offset);
        const time = (now + offset) * 0.00012; 
        
        const angle = time + (i * (Math.PI * 2 / cards.length));
        const x = centerX + Math.cos(angle) * 140; // è»Œé“å¯¬åº¦
        const y = centerY + Math.sin(angle) * 300; // è»Œé“é«˜åº¦
        const z = Math.sin(angle);

        card.style.left = `${x}px`;
        card.style.top = `${y}px`;
        card.style.transform = `translate(-50%, -50%) scale(${0.8 + z * 0.12})`;
        card.style.opacity = 0.4 + (z + 1) * 0.3;
        card.style.zIndex = Math.round((z + 1) * 10);
      });
      requestAnimationFrame(updateOrbit);
    }
    updateOrbit();

    const v = document.getElementById('v');
    const hand = document.getElementById('hand');
    
    function togglePlay() { 
      if(v.paused) {
        v.play();
        // æ’­æ”¾æ™‚è®“æ‰€æœ‰é‘½çŸ³æ›´äº®ä¸€äº›
        document.querySelectorAll('.hour-marker').forEach(marker => {
          marker.style.filter = 'drop-shadow(0 0 8px var(--accent))';
        });
      } else {
        v.pause();
        // æš«åœæ™‚é‘½çŸ³æ¢å¾©åŸç‹€
        document.querySelectorAll('.hour-marker').forEach(marker => {
          if (marker.classList.contains('hour-12') || 
              marker.classList.contains('hour-3') || 
              marker.classList.contains('hour-6') || 
              marker.classList.contains('hour-9')) {
            marker.style.filter = 'drop-shadow(0 0 8px var(--accent))';
          } else {
            marker.style.filter = 'drop-shadow(0 0 6px var(--accent))';
          }
        });
      } 
    }
    
    function setHand(deg) { 
      hand.style.transform = `rotate(${deg}deg)`; 
    }
    
    window.onclick = () => document.querySelectorAll('.lyric-card').forEach(c => c.classList.remove('expanded'));
    
    // é é¢åŠ è¼‰å®Œæˆå¾Œå‰µå»ºé‘½çŸ³æ™‚æ¨™
    window.addEventListener('load', function() {
      createDiamondMarkers();
      
      // æ·»åŠ é¼ æ¨™æ‡¸åœæ•ˆæœ
      const markers = document.querySelectorAll('.hour-marker');
      markers.forEach(marker => {
        marker.addEventListener('mouseenter', function() {
          this.style.filter = 'drop-shadow(0 0 12px var(--accent)) drop-shadow(0 0 6px rgba(255, 255, 255, 0.8))';
          this.style.opacity = '1';
          this.style.zIndex = '15'; // æ‡¸åœæ™‚åœ¨æœ€ä¸Šå±¤
        });
        
        marker.addEventListener('mouseleave', function() {
          const hour = this.classList[1] ? this.classList[1].replace('hour-', '') : '';
          if (hour === '12' || hour === '3' || hour === '6' || hour === '9') {
            this.style.filter = 'drop-shadow(0 0 8px var(--accent))';
            this.style.opacity = '0.95';
          } else {
            this.style.filter = 'drop-shadow(0 0 6px var(--accent))';
            this.style.opacity = '0.8';
          }
          this.style.zIndex = '6';
        });
      });
    });

    // è¦–çª—å¤§å°è®ŠåŒ–æ™‚é‡æ–°å®šä½é‘½çŸ³
    window.addEventListener('resize', function() {
      // ç§»é™¤èˆŠçš„é‘½çŸ³
      document.querySelectorAll('.hour-marker').forEach(marker => marker.remove());
      // é‡æ–°å‰µå»ºé‘½çŸ³
      createDiamondMarkers();
    });
  </script>
</body>
</html>
